<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>宠物领养系统 - 领养确认</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"
    />
    <style>
      /* Page specific styles */
      .confirmation-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
      }

      .confirmation-header {
        text-align: center;
        margin-bottom: 40px;
      }

      .confirmation-header h1 {
        color: var(--primary-color);
        margin-bottom: 15px;
      }

      .confirmation-header p {
        color: #666;
        max-width: 600px;
        margin: 0 auto;
      }

      .confirmation-card {
        background-color: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        padding: 30px;
        margin-bottom: 30px;
      }

      .confirmation-message {
        background-color: #d4edda;
        border-left: 4px solid #28a745;
        padding: 15px;
        margin: 20px 0;
        border-radius: 0 var(--border-radius) var(--border-radius) 0;
      }

      .confirmation-message p {
        color: #155724;
        margin: 0;
        display: flex;
        align-items: center;
      }

      .confirmation-message i {
        margin-right: 10px;
        font-size: 20px;
      }

      .pet-info {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 30px;
      }

      .pet-image {
        width: 200px;
        height: 200px;
        border-radius: var(--border-radius);
        object-fit: cover;
      }

      .pet-details {
        flex: 1;
        min-width: 300px;
      }

      .pet-name {
        font-size: 24px;
        font-weight: 500;
        margin-bottom: 15px;
        color: var(--text-color);
      }

      .pet-detail {
        display: flex;
        margin-bottom: 10px;
        color: #666;
      }

      .pet-detail strong {
        width: 120px;
        color: var(--text-color);
      }

      .delivery-info {
        background-color: #f8f9fa;
        border-radius: var(--border-radius);
        padding: 20px;
        margin: 20px 0;
      }

      .delivery-info h3 {
        margin-bottom: 15px;
        color: var(--primary-color);
      }

      .delivery-detail {
        display: flex;
        margin-bottom: 10px;
      }

      .delivery-detail strong {
        width: 120px;
      }

      .checklist {
        margin: 30px 0;
      }

      .checklist h3 {
        margin-bottom: 15px;
        color: var(--primary-color);
      }

      .checklist-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
      }

      .checklist-item input[type="checkbox"] {
        margin-top: 5px;
        margin-right: 10px;
      }

      .checklist-content {
        flex: 1;
      }

      .checklist-content h4 {
        margin-bottom: 5px;
      }

      .checklist-content p {
        margin: 0;
        color: #666;
        font-size: 14px;
      }

      .signature-section {
        margin: 30px 0;
      }

      .signature-section h3 {
        margin-bottom: 15px;
        color: var(--primary-color);
      }

      .signature-pad {
        width: 100%;
        height: 200px;
        border: 1px dashed #ccc;
        border-radius: var(--border-radius);
        margin-bottom: 15px;
        position: relative;
      }

      .signature-canvas {
        width: 100%;
        height: 100%;
        cursor: crosshair;
      }

      .signature-actions {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      .signature-actions button {
        padding: 10px 15px;
        background: none;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .signature-actions button:hover {
        border-color: var(--primary-color);
        color: var(--primary-color);
      }

      .confirmation-text {
        margin: 20px 0;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: var(--border-radius);
        font-size: 14px;
        line-height: 1.6;
      }

      .confirmation-actions {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
      }

      .confirmation-complete {
        text-align: center;
        padding: 40px 0;
      }

      .confirmation-complete i {
        font-size: 64px;
        color: var(--primary-color);
        margin-bottom: 20px;
        display: block;
      }

      .confirmation-complete h2 {
        margin-bottom: 20px;
        color: var(--primary-color);
      }

      .confirmation-complete p {
        margin-bottom: 30px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .confirmation-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      /* 拍照上传区域 */
      .photo-upload {
        margin: 30px 0;
      }

      .photo-upload h3 {
        margin-bottom: 15px;
        color: var(--primary-color);
      }

      .photo-upload p {
        margin-bottom: 15px;
        color: #666;
      }

      .photo-area {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 15px;
      }

      .photo-box {
        width: 150px;
        height: 150px;
        border: 2px dashed #ddd;
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.3s;
      }

      .photo-box:hover {
        border-color: var(--primary-color);
      }

      .photo-box i {
        font-size: 24px;
        color: #666;
        margin-bottom: 5px;
      }

      .photo-box span {
        font-size: 12px;
        color: #666;
      }

      .photo-box img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .photo-box .remove-photo {
        position: absolute;
        top: 5px;
        right: 5px;
        width: 24px;
        height: 24px;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 2;
      }

      .photo-instruction {
        margin-top: 10px;
        font-size: 14px;
        color: #666;
      }

      @media (max-width: 768px) {
        .confirmation-actions {
          flex-direction: column;
        }

        .photo-area {
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container">
        <nav>
          <div class="logo">宠爱有家</div>
          <ul class="nav-links">
            <li><a href="../index.html">首页</a></li>
            <li><a href="pets.html">宠物领养</a></li>
            <li><a href="forum.html">社区论坛</a></li>
            <li><a href="consultation.html">在线问诊</a></li>
            <li><a href="about.html">关于我们</a></li>
            <li><a href="login.html" class="btn">登录/注册</a></li>
            <li>
              <a href="user-center.html" class="btn btn-secondary">个人中心</a>
            </li>
          </ul>
          <div class="menu-toggle">
            <i class="bi bi-list"></i>
          </div>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main>
      <div class="confirmation-container">
        <div class="confirmation-header">
          <h1>领养确认</h1>
          <p>请确认宠物已安全抵达，并完成最后的领养确认流程。</p>
        </div>

        <!-- 提示信息 -->
        <div class="confirmation-message">
          <p>
            <i class="bi bi-check-circle-fill"></i>
            您的宠物已抵达指定地点，请核对宠物信息并完成领养确认。
          </p>
        </div>

        <!-- 确认表单 -->
        <div class="confirmation-card">
          <h2>确认领养信息</h2>

          <!-- 宠物信息 -->
          <div class="pet-info">
            <img
              src="https://placehold.co/600x400/FF9800/FFFFFF?text=金毛犬"
              alt="金毛犬"
              class="pet-image"
            />
            <div class="pet-details">
              <h3 class="pet-name">阳阳（金毛犬）</h3>
              <div class="pet-detail">
                <strong>品种：</strong>
                <span>金毛犬</span>
              </div>
              <div class="pet-detail">
                <strong>性别：</strong>
                <span>公</span>
              </div>
              <div class="pet-detail">
                <strong>年龄：</strong>
                <span>2岁</span>
              </div>
              <div class="pet-detail">
                <strong>健康状况：</strong>
                <span>已注射疫苗，已绝育，身体健康</span>
              </div>
              <div class="pet-detail">
                <strong>芯片编号：</strong>
                <span>PET123456789</span>
              </div>
              <div class="pet-detail">
                <strong>申请单号：</strong>
                <span>AD202311150001</span>
              </div>
            </div>
          </div>

          <!-- 配送信息 -->
          <div class="delivery-info">
            <h3>配送信息</h3>
            <div class="delivery-detail">
              <strong>接收人：</strong>
              <span>张三</span>
            </div>
            <div class="delivery-detail">
              <strong>接收地址：</strong>
              <span>北京市朝阳区建国路89号</span>
            </div>
            <div class="delivery-detail">
              <strong>联系电话：</strong>
              <span>138****5678</span>
            </div>
            <div class="delivery-detail">
              <strong>配送人员：</strong>
              <span>李师傅（专业宠物运送员）</span>
            </div>
            <div class="delivery-detail">
              <strong>配送员电话：</strong>
              <span>139****1234</span>
            </div>
            <div class="delivery-detail">
              <strong>抵达时间：</strong>
              <span>2023-11-25 10:30</span>
            </div>
          </div>

          <!-- 拍照上传 -->
          <div class="photo-upload">
            <h3>上传宠物接收照片</h3>
            <p>请上传您与宠物的合照，以及宠物的近照，确认宠物的状态良好。</p>

            <div class="photo-area">
              <div class="photo-box" id="photo1">
                <i class="bi bi-camera"></i>
                <span>您与宠物合照</span>
                <input
                  type="file"
                  accept="image/*"
                  style="display: none"
                  id="photo1-input"
                />
              </div>

              <div class="photo-box" id="photo2">
                <i class="bi bi-camera"></i>
                <span>宠物近照</span>
                <input
                  type="file"
                  accept="image/*"
                  style="display: none"
                  id="photo2-input"
                />
              </div>

              <div class="photo-box" id="photo3">
                <i class="bi bi-camera"></i>
                <span>宠物环境照</span>
                <input
                  type="file"
                  accept="image/*"
                  style="display: none"
                  id="photo3-input"
                />
              </div>
            </div>

            <div class="photo-instruction">
              <p>* 点击框框上传照片，您也可以直接拍照上传</p>
            </div>
          </div>

          <!-- 领养确认清单 -->
          <div class="checklist">
            <h3>领养确认清单</h3>
            <div class="checklist-item">
              <input type="checkbox" id="check1" required />
              <div class="checklist-content">
                <h4>宠物状态良好</h4>
                <p>
                  我已检查宠物的外观和健康状况，确认宠物状态良好，无明显健康问题。
                </p>
              </div>
            </div>

            <div class="checklist-item">
              <input type="checkbox" id="check2" required />
              <div class="checklist-content">
                <h4>物品清单完整</h4>
                <p>
                  我已收到所有随宠物一起送达的物品，包括：宠物档案、疫苗本、宠物用品等。
                </p>
              </div>
            </div>

            <div class="checklist-item">
              <input type="checkbox" id="check3" required />
              <div class="checklist-content">
                <h4>了解养护责任</h4>
                <p>
                  我已了解并准备承担照顾宠物的责任，包括日常喂养、定期体检、疫苗接种等。
                </p>
              </div>
            </div>

            <div class="checklist-item">
              <input type="checkbox" id="check4" required />
              <div class="checklist-content">
                <h4>同意后续回访</h4>
                <p>
                  我同意平台在领养后的3个月、6个月和1年时进行回访，了解宠物的适应情况。
                </p>
              </div>
            </div>
          </div>

          <!-- 电子签名区域 -->
          <div class="signature-section">
            <h3>电子签名</h3>
            <p>
              请在下方签署您的姓名，以确认您已收到宠物并同意遵守《宠物领养协议》中的条款。
            </p>

            <div class="signature-pad">
              <canvas id="signature-canvas" class="signature-canvas"></canvas>
            </div>

            <div class="signature-actions">
              <button id="clear-signature">
                <i class="bi bi-eraser"></i> 清除签名
              </button>
            </div>

            <div class="confirmation-text">
              <p>本人确认已收到上述宠物，并承诺：</p>
              <ol>
                <li>为宠物提供适当的食物、住所和医疗照顾；</li>
                <li>不遗弃、虐待或转让该宠物；</li>
                <li>如无法继续照顾宠物，将联系平台寻求帮助；</li>
                <li>定期向平台提供宠物生活状况的照片或视频；</li>
                <li>允许平台在必要时进行回访。</li>
              </ol>
              <p>本人已阅读并同意遵守《宠物领养协议》中的所有条款和条件。</p>
            </div>
          </div>

          <div class="confirmation-actions">
            <button class="btn">暂不确认</button>
            <button class="btn btn-secondary" id="confirm-button">
              确认领养
            </button>
          </div>
        </div>

        <!-- 确认成功（默认隐藏） -->
        <div
          class="confirmation-complete"
          style="display: none"
          id="confirmation-success"
        >
          <i class="bi bi-check-circle"></i>
          <h2>恭喜您，领养确认成功！</h2>
          <p>
            您已成功完成领养确认流程，宠物"阳阳"现在正式成为您家庭的一员。我们希望您和您的新伙伴共度美好时光！
          </p>
          <p>
            我们会在3个月、6个月和1年时通过邮件或电话联系您，了解宠物的适应情况。如果您有任何问题，随时可以联系我们的客服团队。
          </p>

          <div class="confirmation-buttons">
            <a href="pets.html" class="btn">浏览更多宠物</a>
            <a href="../index.html" class="btn btn-secondary">返回首页</a>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-links">
          <div class="footer-section">
            <h3>关于我们</h3>
            <ul>
              <li><a href="about.html">平台介绍</a></li>
              <li><a href="about.html#team">团队成员</a></li>
              <li><a href="about.html#contact">联系我们</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>服务与支持</h3>
            <ul>
              <li><a href="faq.html">常见问题</a></li>
              <li><a href="terms.html">用户协议</a></li>
              <li><a href="privacy.html">隐私政策</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>联系方式</h3>
            <ul>
              <li><i class="bi bi-envelope"></i> contact@petadoption.com</li>
              <li><i class="bi bi-telephone"></i> 400-888-8888</li>
              <li><i class="bi bi-geo-alt"></i> 北京市海淀区XX路XX号</li>
            </ul>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2023 宠爱有家 - 宠物领养平台 版权所有</p>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 电子签名功能
        const canvas = document.getElementById("signature-canvas");
        const clearButton = document.getElementById("clear-signature");
        const ctx = canvas.getContext("2d");
        let isDrawing = false;

        // 设置canvas尺寸
        function resizeCanvas() {
          const containerWidth = canvas.parentElement.clientWidth;
          canvas.width = containerWidth;
          canvas.height = 200;

          // 初始化画布
          ctx.fillStyle = "white";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.strokeStyle = "#000";
          ctx.lineWidth = 2;
          ctx.lineCap = "round";
        }

        // 初始化和窗口大小变化时重设尺寸
        resizeCanvas();
        window.addEventListener("resize", resizeCanvas);

        // 开始绘制
        canvas.addEventListener("mousedown", startDrawing);
        canvas.addEventListener("touchstart", function (e) {
          e.preventDefault();
          const touch = e.touches[0];
          startDrawing(touch);
        });

        function startDrawing(e) {
          isDrawing = true;
          draw(e);
        }

        // 绘制中
        canvas.addEventListener("mousemove", draw);
        canvas.addEventListener("touchmove", function (e) {
          e.preventDefault();
          const touch = e.touches[0];
          draw(touch);
        });

        function draw(e) {
          if (!isDrawing) return;

          const rect = canvas.getBoundingClientRect();
          const x = (e.clientX || e.pageX) - rect.left;
          const y = (e.clientY || e.pageY) - rect.top;

          ctx.lineTo(x, y);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(x, y);
        }

        // 停止绘制
        canvas.addEventListener("mouseup", stopDrawing);
        canvas.addEventListener("mouseleave", stopDrawing);
        canvas.addEventListener("touchend", stopDrawing);

        function stopDrawing() {
          isDrawing = false;
          ctx.beginPath();
        }

        // 清除签名
        clearButton.addEventListener("click", function () {
          ctx.fillStyle = "white";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.beginPath();
          ctx.strokeStyle = "#000";
        });

        // 照片上传功能
        const photoBoxes = document.querySelectorAll(".photo-box");

        photoBoxes.forEach((box) => {
          const input = box.querySelector("input");

          box.addEventListener("click", () => {
            input.click();
          });

          input.addEventListener("change", function () {
            if (this.files && this.files[0]) {
              const reader = new FileReader();

              reader.onload = function (e) {
                // 移除原有内容
                while (box.firstChild) {
                  box.removeChild(box.firstChild);
                }

                // 创建图片元素
                const img = document.createElement("img");
                img.src = e.target.result;
                box.appendChild(img);

                // 添加删除按钮
                const removeBtn = document.createElement("div");
                removeBtn.className = "remove-photo";
                removeBtn.innerHTML = '<i class="bi bi-x"></i>';
                box.appendChild(removeBtn);

                // 删除图片
                removeBtn.addEventListener("click", function (event) {
                  event.stopPropagation();
                  // 清空input
                  input.value = "";
                  // 恢复原有UI
                  box.innerHTML = "";
                  const icon = document.createElement("i");
                  icon.className = "bi bi-camera";
                  box.appendChild(icon);

                  const span = document.createElement("span");
                  span.textContent =
                    input.id === "photo1-input"
                      ? "您与宠物合照"
                      : input.id === "photo2-input"
                      ? "宠物近照"
                      : "宠物环境照";
                  box.appendChild(span);

                  box.appendChild(input);
                });
              };

              reader.readAsDataURL(this.files[0]);
            }
          });
        });

        // 确认领养按钮
        const confirmButton = document.getElementById("confirm-button");
        const confirmationCard = document.querySelector(".confirmation-card");
        const confirmationSuccess = document.getElementById(
          "confirmation-success"
        );
        const checkboxes = document.querySelectorAll(
          '.checklist-item input[type="checkbox"]'
        );

        confirmButton.addEventListener("click", function () {
          // 检查是否所有复选框都已勾选
          let allChecked = true;
          checkboxes.forEach((checkbox) => {
            if (!checkbox.checked) {
              allChecked = false;
            }
          });

          // 检查是否有签名
          const signatureData = canvas.toDataURL();
          const emptySignature = document.createElement("canvas");
          emptySignature.width = canvas.width;
          emptySignature.height = canvas.height;
          const emptyCtx = emptySignature.getContext("2d");
          emptyCtx.fillStyle = "white";
          emptyCtx.fillRect(0, 0, emptySignature.width, emptySignature.height);
          const emptySignatureData = emptySignature.toDataURL();

          const hasSignature = signatureData !== emptySignatureData;

          // 检查是否上传了照片
          const hasPhotos =
            document.querySelectorAll(".photo-box img").length > 0;

          if (!allChecked) {
            alert("请确认所有确认清单项目");
            return;
          }

          if (!hasSignature) {
            alert("请在签名区域签署您的姓名");
            return;
          }

          if (!hasPhotos) {
            alert("请至少上传一张照片");
            return;
          }

          // 提交确认
          confirmationCard.style.display = "none";
          confirmationSuccess.style.display = "block";

          // 滚动到顶部
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        });
      });
    </script>
  </body>
</html>
